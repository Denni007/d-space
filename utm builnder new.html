<!DOCTYPE html><!--  Last Published: Fri Mar 03 2023 16:34:17 GMT+0000 (Coordinated Universal Time)  -->
<html lang="en" data-wf-page="63dcd3aa9589a8c18aea83c2" data-wf-site="636583715dc3eb3649afa2e0">

<head>
    <meta charset="utf-8">
    <title>StarLuxe Tech - Contact us</title>
    <meta content="Contact us" property="og:title">
    <meta content="Contact us" property="twitter:title">
    <meta content="width=device-width, initial-scale=1" name="viewport">
    <meta name="robots" content="index, follow">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="description" content="Get in touch with us for inquiries, support, or to learn more about our services. Weâ€™re here to help you succeed.">
    <meta name="keywords" content="contact us, customer support, inquiries, data services, analytics, server-side tracking">
    <link href="/css/normalize.css" rel="stylesheet" type="text/css">
    <link href="/css/webflow.css" rel="stylesheet" type="text/css">
    <link href="/css/dspace.css" rel="stylesheet" type="text/css">
    <link href="https://fonts.googleapis.com" rel="preconnect">
    <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin="anonymous">
    <script src="https://ajax.googleapis.com/ajax/libs/webfont/1.6.26/webfont.js" type="text/javascript"></script>
    <script
        type="text/javascript">WebFont.load({ google: { families: ["Lato:100,100italic,300,300italic,400,400italic,700,700italic,900,900italic", "Open Sans:300,300italic,400,400italic,600,600italic,700,700italic,800,800italic", "Inter:300,regular,500,600,700"] } });</script>
    <!-- [if lt IE 9]><script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.min.js" type="text/javascript"></script><![endif] -->
    <script
        type="text/javascript">!function (o, c) { var n = c.documentElement, t = " w-mod-"; n.className += t + "js", ("ontouchstart" in o || o.DocumentTouch && c instanceof DocumentTouch) && (n.className += t + "touch") }(window, document);</script>
        <link rel="apple-touch-icon" sizes="57x57" href="/images/favicon/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/images/favicon/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/images/favicon/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/images/favicon/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/images/favicon/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/images/favicon/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/images/favicon/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/images/favicon/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/images/favicon/apple-icon-180x180.png">
    <link rel="icon" type="image/png" sizes="192x192"  href="/images/favicon/android-icon-192x192.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="96x96" href="/images/favicon/favicon-96x96.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon/favicon-16x16.png">
<script src="/js/dataexpert.js" type="text/javascript"></script>
<style>
  body {
    -moz-osx-font-smoothing: grayscale;
    -webkit-font-smoothing: antialiased;
  }
</style>
<style>
  .body {
    padding-bottom: 0px;
    scroll-behavior: smooth !important
  }
</style>
</head>

<body >
    

        <div id="Top" class="back-to-top-container">
            <div class="back-to-top-button-wrapper">
                <a href="#Top" class="button-circle bg-gray-3 w-inline-block">
                    <img src="/images/icon-arrow-up.svg" alt="Up arrow" class="button-circle-icon">
                </a>

            </div>
        </div>
        <div class="navbar-wrapper sticky-top">
            <div class="container">
              <div data-collapse="medium" data-animation="default" data-duration="400" data-easing="ease" data-easing2="ease"
                role="banner" class="navbar w-nav">
                <div class="navbar-row">
                  <div class="div-block-6">
                    <a href="/" class="navbar-1-brand w-nav-brand">
                      <img src="https://framerusercontent.com/images/H6RRGr6UHvZqqmCJoDnHrRqi9g.png" size="89" alt="Logo">
                    </a>
                    <nav role="navigation" class="nav-menu w-nav-menu">
                                      <a href="/case-studies" class="nav-link w-nav-link">Case Study</a> 
                <a href="/blogs" class="nav-link w-nav-link">Blogs</a>

                      <!-- <a href="#service" class="nav-link w-nav-link">Services</a> -->
        
                      <div data-delay="0" data-hover="1" class="w-dropdown" style="">
                        <div class="nav-link w-dropdown-toggle" id="w-dropdown-toggle-0" aria-controls="w-dropdown-list-0"
                          aria-haspopup="menu" aria-expanded="false" role="button" tabindex="0">
                          <div class="row row-align-center">
                            <div>Services</div><img
                              src="https://assets.website-files.com/5dcb2e333e05bec4ef2fee2f/5dd224eeb88d0076b74fe33e_icon-caret-down.svg"
                              alt="" class="dropdown-link-icon">
                          </div>
                        </div>
                        <nav class="dropdown-list w-dropdown-list" id="w-dropdown-list-0" aria-labelledby="w-dropdown-toggle-0">
                          <div class="dropdown-list-wrapper">
                            <a href="/ga4-migration" class="dropdown-item w-dropdown-link" tabindex="0">GA4 migration</a>
                            <a href="/tracking" class="dropdown-item w-dropdown-link" tabindex="0">Tracking & Audit </a>
        <a href="/service/conversion-rate-optimization"
 class="dropdown-item w-dropdown-link" tabindex="0">CRO Service</a><a href="/gdpr" class="dropdown-item w-dropdown-link" tabindex="0">GDPR Consent Service</a>                            <a href="/s2s-gtm" class="dropdown-item w-dropdown-link" tabindex="0">Server Side
                              Tracking</a>
                            <div class="dropdown-bg"></div>
                          </div>
                        </nav>
                      </div>
                      <a href="/contact-us" class="nav-link w-nav-link">Contact Us</a><a href="/our-team" class="nav-link w-nav-link">Team</a>
                    </nav>
                  </div>
                  <div class="navbar-controls ">
                    <div class="navbar-buttons ">
                      <a href="/contact-us" target="_blank" class="button w-button"> Meet With US</a>
                    </div>
                    <div class="menu-button w-nav-button"><img src="/images/icon-menu.svg" alt="Menu icon"></div>
                  </div>
                </div>
              </div>
            </div>
          </div>


   

<style>
    body {
      font-family: sans-serif;
      background: #11131a;
      color: #fff;
      margin: 0;
      padding: 2rem;
    }

    .panel-body {
      max-width: 700px;
      margin: 0 auto;
      background: #1c1e26;
      padding: 2rem;
      border-radius: 8px;
    }

    .space-bottom {
      margin-bottom: 1.5rem;
    }

    .card-heading {
      font-size: 1.5rem;
      font-weight: bold;
    }

    .form-grid-halves {
      gap: 1rem;
      flex-wrap: wrap;
    }

    .form-grid-halves .form-input {
      flex: 1;
    }

    .form-input,
    .form-input.w-select,
    .form-input.textarea {
      background: #2a2c36;
      border: 1px solid #3a3c46;
      padding: 0.75rem 1rem;
      border-radius: 6px;
      color: #fff;
      font-size: 1rem;
      width: 100%;
      margin-bottom: 1rem;
    }

    label {
      display: block;
      margin: 0.5rem 0 0.25rem;
      font-size: 0.95rem;
      color: #ccc;
    }

    .w-button {
      background: #ffc107;
      color: #111;
      font-weight: bold;
      border: none;
      border-radius: 6px;
      padding: 1rem;
      cursor: pointer;
      font-size: 1rem;
      width: 100%;
      transition: background 0.2s ease-in-out;
    }

    .w-button:hover {
      background: #e0a800;
    }

    textarea {
      min-height: 100px;
    }
  </style>


<body>

  <div class="panel-body">
    <div class="space-bottom">
      <h3 class="card-heading display-inline">Build Your UTM URL</h3>
    </div>
    <div class="form w-form">
      <form id="utm-form" class="form-vertical">
        <div class="form-grid-halves">
          <label for="ga4-channel-select">GA4 Channel (optional)</label>
          <select id="ga4-channel-select" class="form-input w-select" name="channel">
            <option value="">All channels (no filtering)</option>
            </select>

          <input type="text" class="form-input w-input" id="website-url" name="url" placeholder="Website URL *" required>
        </div>

        <label for="source">Campaign Source (utm_source) *</label>
        <select id="source" class="form-input w-select" required>
          </select>
        <p class="text-xs text-gray-500 dark:text-gray-400 mt-1">Where the traffic comes from</p>

        <div class="form-grid-halves">
          <div>
            <label for="medium">Campaign Medium (utm_medium) *</label>
            <select id="medium" class="form-input w-select" required>
              </select>
            <p class="text-xs text-gray-500 dark:text-gray-400 mt-1">How the traffic gets to you</p>
          </div>
          <div>
            <label for="campaign">Campaign Name (utm_campaign) *</label>
            <input type="text" class="form-input w-input" id="campaign" name="campaign" placeholder="Campaign Name (utm_campaign) *" required>
            <p class="text-xs text-gray-500 dark:text-gray-400 mt-1">What campaign it's for</p>
          </div>
        </div>

        <div class="space-y-6 mt-6">
          <h4>Optional UTM Parameters</h4>
          <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <input type="text" class="form-input w-input" id="utm_term" placeholder="Campaign Term (utm_term)">
            <input type="text" class="form-input w-input" id="utm_content" placeholder="Campaign Content (utm_content)">
            <input type="text" class="form-input w-input" id="utm_id" placeholder="Campaign ID (utm_id)">
            <input type="text" class="form-input w-input" id="utm_source_platform" placeholder="Source Platform (utm_source_platform)">
            <input type="text" class="form-input w-input" id="utm_creative_format" placeholder="Creative Format (utm_creative_format)">
            <input type="text" class="form-input w-input" id="utm_marketing_tactic" placeholder="Marketing Tactic (utm_marketing_tactic)">
          </div>

          <div class="mt-8 pt-6 border-t border-gray-200 dark:border-gray-600">
            <div class="flex items-center justify-between mb-4">
              <h4 class="text-md font-semibold text-gray-900 dark:text-gray-100">Custom Parameters</h4>
              <button type="button" id="add-custom-param" class="button-small bg-blue-600 hover:bg-blue-700 text-white">Add Parameter</button>
            </div>
            <div id="custom-params-container" class="space-y-3">
              <div class="text-center py-8 text-gray-500 dark:text-gray-400" id="no-custom-params-message">
                <svg class="w-12 h-12 mx-auto mb-3 opacity-50" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path>
                </svg>
                <p>No custom parameters added. Click "Add Parameter" to add custom tracking parameters.</p>
              </div>
            </div>
          </div>
        </div>

        <input type="submit" value="Generate UTM URL" class="button-large bg-primary-4 w-button mt-6">
      </form>

      <div class="space-bottom">
        <h4 style="margin-top: 2rem;">Generated UTM URL:</h4>
        <textarea id="result" class="form-input textarea w-input" readonly></textarea>
        <button type="button" id="copy-generated-url" class="button-small bg-gray-300 hover:bg-gray-400 text-gray-800 mt-2">Copy URL</button>
      </div>
    </div>
  </div>

  <script>
    // Define the R object
    const R = {
      SOURCE_CATEGORY_SEARCH: ["360.cn", "alice", "aol", "ar.search.yahoo.com", "ask", "at.search.yahoo.com", "au.search.yahoo.com", "auone", "avg", "babylon", "baidu", "biglobe", "biglobe.co.jp", "biglobe.ne.jp", "bing", "br.search.yahoo.com", "ca.search.yahoo.com", "centrum.cz", "ch.search.yahoo.com", "cl.search.yahoo.com", "cn.bing.com", "cnn", "co.search.yahoo.com", "comcast", "conduit", "daum", "daum.net", "de.search.yahoo.com", "dk.search.yahoo.com", "dogpile", "dogpile.com", "duckduckgo", "ecosia.org", "email.seznam.cz", "eniro", "es.search.yahoo.com", "espanol.search.yahoo.com", "exalead.com", "excite.com", "fi.search.yahoo.com", "firmy.cz", "fr.search.yahoo.com", "globo", "go.mail.ru", "google", "google-play", "hk.search.yahoo.com", "id.search.yahoo.com", "in.search.yahoo.com", "incredimail", "it.search.yahoo.com", "kvasir", "lens.google.com", "lite.qwant.com", "lycos", "m.baidu.com", "m.naver.com", "m.search.naver.com", "m.sogou.com", "mail.rambler.ru", "mail.yandex.ru", "malaysia.search.yahoo.com", "msn", "msn.com", "mx.search.yahoo.com", "najdi", "naver", "naver.com", "news.google.com", "nl.search.yahoo.com", "no.search.yahoo.com", "ntp.msn.com", "nz.search.yahoo.com", "onet", "onet.pl", "pe.search.yahoo.com", "ph.search.yahoo.com", "pl.search.yahoo.com", "play.google.com", "qwant", "qwant.com", "rakuten", "rakuten.co.jp", "rambler", "rambler.ru", "se.search.yahoo.com", "search.aol.co.uk", "search.aol.com", "search.google.com", "search.smt.docomo.ne.jp", "search.ukr.net", "search-results", "secureurl.ukr.net", "seznam", "seznam.cz", "sg.search.yahoo.com", "so.com", "sogou", "sogou.com", "sp-web.search.auone.jp", "startsiden", "startsiden.no", "suche.aol.de", "terra", "th.search.yahoo.com", "tr.search.yahoo.com", "tut.by", "tw.search.yahoo.com", "uk.search.yahoo.com", "ukr", "us.search.yahoo.com", "virgilio", "vn.search.yahoo.com", "wap.sogou.com", "webmaster.yandex.ru", "websearch.rakuten.co.jp", "yahoo", "yahoo.co.jp", "yahoo.com", "yandex", "yandex.by", "yandex.com", "yandex.com.tr", "yandex.fr", "yandex.kz", "yandex.ru", "yandex.ua", "yandex.uz", "zen.yandex.ru"],
      SOURCE_CATEGORY_SHOPPING: ["aax.amazon-adsystem.com", "aax-us-east.amazon-adsystem.com", "alibaba", "alibaba.com", "amazon", "amazon.co.uk", "amazon.com", "apps.shopify.com", "checkout.shopify.com", "checkout.stripe.com", "cr.shopping.naver.com", "cr2.shopping.naver.com", "ebay", "ebay.co.uk", "ebay.com", "ebay.com.au", "ebay.de", "etsy", "etsy.com", "google shopping", "igshopping", "m.alibaba.com", "m.shopping.naver.com", "mercadolibre", "mercadolibre.com", "mercadolibre.com.ar", "mercadolibre.com.mx", "message.alibaba.com", "msearch.shopping.naver.com", "nl.shopping.net", "no.shopping.net", "offer.alibaba.com", "one.walmart.com", "order.shopping.yahoo.co.jp", "partners.shopify.com", "s3.amazonaws.com", "se.shopping.net", "shop.app", "shopify", "shopify.com", "shopping.naver.com", "shopping.yahoo.co.jp", "shopping.yahoo.com", "shopzilla", "shopzilla.com", "simplycodes.com", "store.shopping.yahoo.co.jp", "stripe", "stripe.com", "uk.shopping.net", "walmart", "walmart.com"],
      SOURCE_CATEGORY_SOCIAL: ["43things", "43things.com", "51.com", "5ch.net", "academia.edu", "activerain", "activerain.com", "activeworlds", "activeworlds.com", "addthis", "addthis.com", "airg.ca", "allnurses.com", "allrecipes.com", "alumniclass", "alumniclass.com", "ameba.jp", "ameblo.jp", "americantowns", "americantowns.com", "amp.reddit.com", "ancestry.com", "anobii", "anobii.com", "answerbag", "answerbag.com", "answers.yahoo.com", "aolanswers", "aolanswers.com", "apps.facebook.com", "ar.pinterest.com", "artstation.com", "askubuntu", "askubuntu.com", "asmallworld.com", "athlinks", "athlinks.com", "away.vk.com", "awe.sm", "b.hatena.ne.jp", "baby-gaga", "baby-gaga.com", "babyblog.ru", "badoo", "badoo.com", "bebo", "bebo.com", "beforeitsnews", "beforeitsnews.com", "bharatstudent", "bharatstudent.com", "biip.no", "biswap.org", "bit.ly", "blackcareernetwork.com", "blackplanet", "blackplanet.com", "blip.fm", "blog.com", "blog.feedspot.com", "blog.goo.ne.jp", "blog.naver.com", "blog.yahoo.co.jp", "blogg.no", "bloggang.com", "blogger", "blogger.com", "blogher", "blogher.com", "bloglines", "bloglines.com", "blogs.com", "blogsome", "blogsome.com", "blogspot", "blogspot.com", "blogster", "blogster.com", "blurtit", "blurtit.com", "bookmarks.yahoo.co.jp", "bookmarks.yahoo.com", "br.pinterest.com", "brightkite", "brightkite.com", "brizzly", "brizzly.com", "business.facebook.com", "buzzfeed", "buzzfeed.com", "buzznet", "buzznet.com", "cafe.naver.com", "cafemom", "cafemom.com", "camospace", "camospace.com", "canalblog.com", "care.com", "care2", "care2.com", "caringbridge.org", "catster", "catster.com", "cbnt.io", "cellufun", "cellufun.com", "centerblog.net", "chat.zalo.me", "chegg.com", "chicagonow", "chicagonow.com", "chiebukuro.yahoo.co.jp", "classmates", "classmates.com", "classquest", "classquest.com", "co.pinterest.com", "cocolog-nifty", "cocolog-nifty.com", "copainsdavant.linternaute.com", "couchsurfing.org", "cozycot", "cozycot.com", "cross.tv", "crunchyroll", "crunchyroll.com", "cyworld", "cyworld.com", "cz.pinterest.com", "d.hatena.ne.jp", "dailystrength.org", "deluxe.com", "deviantart", "deviantart.com", "dianping", "dianping.com", "digg", "digg.com", "diigo", "diigo.com", "discover.hubpages.com", "disqus", "disqus.com", "dogster", "dogster.com", "dol2day", "dol2day.com", "doostang", "doostang.com", "doppir", "dopplr.com", "douban", "douban.com", "draft.blogger.com", "draugiem.lv", "drugs-forum", "drugs-forum.com", "dzone", "dzone.com", "edublogs.org", "elftown", "elftown.com", "epicurious.com", "everforo.com", "exblog.jp", "extole", "extole.com", "facebook", "facebook.com", "faceparty", "faceparty.com", "fandom.com", "fanpop", "fanpop.com", "fark", "fark.com", "fb", "fb.me", "fc2", "fc2.com", "feedspot", "feministing", "feministing.com", "filmaffinity", "filmaffinity.com", "flickr", "flickr.com", "flipboard", "flipboard.com", "folkdirect", "folkdirect.com", "foodservice", "foodservice.com", "forums.androidcentral.com", "forums.crackberry.com", "forums.imore.com", "forums.nexopia.com", "forums.webosnation.com", "forums.wpcentral.com", "fotki", "fotki.com", "fotolog", "fotolog.com", "foursquare", "foursquare.com", "free.facebook.com", "friendfeed", "friendfeed.com", "fruehstueckstreff.org", "fubar", "fubar.com", "gaiaonline", "gaiaonline.com", "gamerdna", "gamerdna.com", "gather.com", "geni.com", "getpocket.com", "glassboard", "glassboard.com", "glassdoor", "glassdoor.com", "godtube", "godtube.com", "goldenline.pl", "goldstar", "goldstar.com", "goo.gl", "gooblog", "goodreads", "goodreads.com", "google+", "googlegroups.com", "googleplus", "govloop", "govloop.com", "gowalla", "gowalla.com", "gree.jp", "groups.google.com", "gulli.com", "gutefrage.net", "habbo", "habbo.com", "hatena", "hi5", "hi5.com", "hootsuite", "hootsuite.com", "houzz", "houzz.com", "hoverspot", "hoverspot.com", "hr.com", "hu.pinterest.com", "hubculture", "hubculture.com", "hubpages.com", "hyves.net", "hyves.nl", "ibibo", "ibibo.com", "id.pinterest.com", "identi.ca", "ig", "imageshack", "imageshack.com", "imageshack.us", "imvu", "imvu.com", "in.pinterest.com", "insanejournal", "insanejournal.com", "instagram", "instagram.com", "instapaper", "instapaper.com", "internations.org", "interpals.net", "intherooms", "intherooms.com", "irc-galleria.net", "is.gd", "italki", "italki.com", "jammerdirect", "jammerdirect.com", "jappy.com", "jappy.de", "kaboodle.com", "kakao", "kakao.com", "kakaocorp.com", "kaneva", "kaneva.com", "kin.naver.com", "l.facebook.com", "l.instagram.com", "l.messenger.com", "last.fm", "librarything", "librarything.com", "lifestream.aol.com", "line", "line.me", "linkedin", "linkedin.com", "listal", "listal.com", "listography", "listography.com", "livedoor.com", "livedoorblog", "livejournal", "livejournal.com", "lm.facebook.com", "lnkd.in", "m.blog.naver.com", "m.cafe.naver.com", "m.facebook.com", "m.kin.naver.com", "m.vk.com", "m.yelp.com", "mbga.jp", "medium.com", "meetin.org", "meetup", "meetup.com", "meinvz.net", "meneame.net", "menuism.com", "messages.google.com", "messages.yahoo.co.jp", "messenger", "messenger.com", "mix.com", "mixi.jp", "mobile.facebook.com", "mocospace", "mocospace.com", "mouthshut", "mouthshut.com", "movabletype", "movabletype.com", "mubi", "mubi.com", "my.opera.com", "myanimelist.net", "myheritage", "myheritage.com", "mylife", "mylife.com", "mymodernmet", "mymodernmet.com", "myspace", "myspace.com", "netvibes", "netvibes.com", "news.ycombinator.com", "newsshowcase", "nexopia", "ngopost.org", "niconico", "nicovideo.jp", "nightlifelink", "nightlifelink.com", "ning", "ning.com", "nl.pinterest.com", "odnoklassniki.ru", "odnoklassniki.ua", "okwave.jp", "old.reddit.com", "oneworldgroup.org", "onstartups", "onstartups.com", "opendiary", "opendiary.com", "oshiete.goo.ne.jp", "out.reddit.com", "over-blog.com", "overblog.com", "paper.li", "partyflock.nl", "photobucket", "photobucket.com", "pinboard", "pinboard.in", "pingsta", "pingsta.com", "pinterest", "pinterest.at", "pinterest.ca", "pinterest.ch", "pinterest.cl", "pinterest.co.kr", "pinterest.co.uk", "pinterest.com", "pinterest.com.au", "pinterest.com.mx", "pinterest.de", "pinterest.es", "pinterest.fr", "pinterest.it", "pinterest.jp", "pinterest.nz", "pinterest.ph", "pinterest.pt", "pinterest.ru", "pinterest.se", "pixiv.net", "pl.pinterest.com", "playahead.se", "plurk", "plurk.com", "plus.google.com", "plus.url.google.com", "pocket.co", "posterous", "posterous.com", "pro.homeadvisor.com", "pulse.yahoo.com", "qapacity", "qapacity.com", "quechup", "quechup.com", "quora", "quora.com", "qzone.qq.com", "ravelry", "ravelry.com", "reddit", "reddit.com", "redux", "redux.com", "renren", "renren.com", "researchgate.net", "reunion", "reunion.com", "reverbnation", "reverbnation.com", "rtl.de", "ryze", "ryze.com", "salespider", "salespider.com", "scoop.it", "screenrant", "screenrant.com", "scribd", "scribd.com", "scvngr", "scvngr.com", "secondlife", "secondlife.com", "serverfault", "serverfault.com", "shareit", "sharethis", "sharethis.com", "shvoong.com", "sites.google.com", "skype", "skyrock", "skyrock.com", "slashdot.org", "slideshare.net", "smartnews.com", "snapchat", "snapchat.com", "social", "sociallife.com.br", "socialvibe", "socialvibe.com", "spaces.live.com", "spoke", "spoke.com", "spruz", "spruz.com", "ssense.com", "stackapps", "stackapps.com", "stackexchange", "stackexchange.com", "stackoverflow", "stackoverflow.com", "stardoll.com", "stickam", "stickam.com", "studivz.net", "suomi24.fi", "superuser", "superuser.com", "sweeva", "sweeva.com", "t.co", "t.me", "tagged", "tagged.com", "taggedmail", "taggedmail.com", "talkbiznow", "talkbiznow.com", "taringa.net", "techmeme", "techmeme.com", "tencent", "tencent.com", "tiktok", "tiktok.com", "tinyurl", "tinyurl.com", "toolbox", "toolbox.com", "touch.facebook.com", "tr.pinterest.com", "travellerspoint", "travellerspoint.com", "tripadvisor", "tripadvisor.com", "trombi", "trombi.com", "trustpilot", "tudou", "tudou.com", "tuenti", "tuenti.com", "tumblr", "tumblr.com", "tweetdeck", "tweetdeck.com", "twitter", "twitter.com", "twoo.com", "typepad", "typepad.com", "unblog.fr", "urbanspoon.com", "ushareit.com", "ushi.cn", "vampirefreaks", "vampirefreaks.com", "vampirerave", "vampirerave.com", "vg.no", "viadeo.journaldunet.com", "vk.com", "vkontakte.ru", "wakoopa", "wakoopa.com", "wattpad", "wattpad.com", "web.facebook.com", "web.skype.com", "webshots", "webshots.com", "wechat", "wechat.com", "weebly", "weebly.com", "weibo", "weibo.com", "wer-weiss-was.de", "wer-weiss-was.de", "weread", "weread.com", "whatsapp", "whatsapp.com", "wiki.answers.com", "wikihow.com", "wikitravel.org", "woot.com", "wordpress", "wordpress.com", "wordpress.org", "xanga", "xanga.com", "xing", "xing.com", "yahoo-mbga.jp", "yammer", "yammer.com", "yelp", "yelp.co.uk", "yelp.com", "youroom.in", "za.pinterest.com", "zalo", "zoo.gr", "zooppa", "zooppa.com"],
      SOURCE_CATEGORY_VIDEO: ["blog.twitch.tv", "crackle", "crackle.com", "curiositystream", "curiositystream.com", "d.tube", "dailymotion", "dailymotion.com", "dashboard.twitch.tv", "disneyplus", "disneyplus.com", "fast.wistia.net", "help.hulu.com", "help.netflix.com", "hulu", "hulu.com", "id.twitch.tv", "iq.com", "iqiyi", "iqiyi.com", "jobs.netflix.com", "justin.tv", "m.twitch.tv", "music.youtube.com", "netflix", "netflix.com", "player.twitch.tv", "player.vimeo.com", "ted", "ted.com", "twitch", "twitch.tv", "utreon", "utreon.com", "veoh", "veoh.com", "video.ibm.com", "vimeo", "vimeo.com", "wistia", "wistia.com", "youku", "youku.com", "youtube", "youtube.com"]
    };

    // Define the z object
    const z = [{
      name: "Affiliates",
      description: "Affiliates is the channel by which users arrive at your site/app via links on affiliate sites.",
      condition: "Medium = affiliate",
      recommendedMediums: ["affiliate"],
      recommendedSources: []
    }, {
      name: "Audio",
      description: "Audio is the channel by which users arrive at your site/app via ads on audio platforms (e.g., podcast platforms).",
      condition: "Medium exactly matches audio",
      recommendedMediums: ["audio"],
      recommendedSources: []
    }, {
      name: "Cross-network",
      description: "Cross-network is the channel by which users arrive at your site/app via ads that appear on a variety of networks (e.g., Search and Display).",
      condition: 'Campaign Name contains "cross-network"',
      recommendedMediums: [],
      recommendedSources: []
    }, {
      name: "Direct",
      description: "Direct is the channel by which users arrive at your site/app via a saved link or by entering your URL.",
      condition: 'Source exactly matches "(direct)" AND Medium is one of ("(not set)", "(none)")',
      recommendedMediums: ["(not set)", "(none)"],
      recommendedSources: ["(direct)"]
    }, {
      name: "Display",
      description: "Display is the channel by which users arrive at your site/app via display ads, including ads on the Google Display Network.",
      condition: 'Medium is one of ("display", "banner", "expandable", "interstitial", "cpm")',
      recommendedMediums: ["display", "banner", "expandable", "interstitial", "cpm"],
      recommendedSources: []
    }, {
      name: "Email",
      description: "Email is the channel by which users arrive at your site/app via links in email.",
      condition: "Source = email|e-mail|e_mail|e mail OR Medium = email|e-mail|e_mail|e mail",
      recommendedMediums: ["email", "e-mail", "e_mail", "e mail"],
      recommendedSources: ["email", "e-mail", "e_mail", "e mail"]
    }, {
      name: "Mobile Push Notifications",
      description: "Mobile Push Notifications is the channel by which users arrive at your site/app via links in mobile-device messages when they're not actively using the app.",
      condition: 'Medium ends with "push" OR Medium contains "mobile" or "notification" OR Source exactly matches "firebase"',
      recommendedMediums: ["push", "mobile", "notification", "mobile_push", "app_push"],
      recommendedSources: ["firebase"]
    }, {
      name: "Organic Search",
      description: "Organic Search is the channel by which users arrive at your site/app via non-ad links in organic-search results.",
      condition: 'Source matches a list of search sites listed under "SOURCE_CATEGORY_SEARCH" OR Medium exactly matches organic',
      recommendedMediums: ["organic"],
      recommendedSources: R.SOURCE_CATEGORY_SEARCH
    }, {
      name: "Organic Shopping",
      description: "Organic Shopping is the channel by which users arrive at your site/app via non-ad links on shopping sites like Amazon or ebay.",
      condition: "Source matches a list of shopping sites OR Campaign name matches regex ^(.*(([^a-df-z]|^)shop|shopping).*)$",
      recommendedMediums: ["organic", "referral"],
      recommendedSources: R.SOURCE_CATEGORY_SHOPPING
    }, {
      name: "Organic Social",
      description: "Organic Social is the channel by which users arrive at your site/app via non-ad links on social sites like Facebook or Twitter.",
      condition: 'Source matches a regex list of social sites OR Medium is one of ("social", "social-network", "social-media", "sm", "social network", "social media")',
      recommendedMediums: ["social", "social-network", "social-media", "sm", "social network", "social media"],
      recommendedSources: R.SOURCE_CATEGORY_SOCIAL
    }, {
      name: "Organic Video",
      description: "Organic Video is the channel by which users arrive at your site/app via non-ad links on video sites like YouTube, TikTok, or Vimeo.",
      condition: "Source matches a list of video sites OR Medium matches regex ^(.*video.*)$",
      recommendedMediums: ["video", "referral"],
      recommendedSources: R.SOURCE_CATEGORY_VIDEO
    }, {
      name: "Paid Other",
      description: "Paid Other is the channel by which users arrive at your site/app via ads, but not through an ad identified as Search, Social, Shopping, or Video.",
      condition: "Medium matches regex ^(.*cp.*|ppc|retargeting|paid.*)$",
      recommendedMediums: ["cpc", "ppc", "paid", "retargeting"],
      recommendedSources: []
    }, {
      name: "Paid Search",
      description: "Paid Search is the channel by which users arrive at your site/app via ads on search-engine sites like Bing, Baidu, or Google.",
      condition: "Source matches a list of search sites AND Medium matches regex ^(.*cp.*|ppc|retargeting|paid.*)$",
      recommendedMediums: ["cpc", "ppc", "paid", "retargeting"],
      recommendedSources: R.SOURCE_CATEGORY_SEARCH
    }, {
      name: "Paid Shopping",
      description: "Paid Shopping is the channel by which users arrive at your site/app via paid ads on shopping sites like Amazon or ebay or on individual retailer sites.",
      condition: "(Source matches a list of shopping sites OR Campaign Name matches regex ^(.*(([^a-df-z]|^)shop|shopping).*)$) AND Medium matches regex ^(.*cp.*|ppc|retargeting|paid.*)$",
      recommendedMediums: ["cpc", "ppc", "paid", "retargeting"],
      recommendedSources: R.SOURCE_CATEGORY_SHOPPING
    }, {
      name: "Paid Social",
      description: "Paid Social is the channel by which users arrive at your site/app via ads on social sites like Facebook and Twitter.",
      condition: "Source matches a regex list of social sites AND Medium matches regex ^(.*cp.*|ppc|retargeting|paid.*)$",
      recommendedMediums: ["cpc", "ppc", "paid", "retargeting"],
      recommendedSources: R.SOURCE_CATEGORY_SOCIAL
    }, {
      name: "Paid Video",
      description: "Paid Video is the channel by which users arrive at your site/app via ads on video sites like TikTok, Vimeo, and YouTube.",
      condition: "Source matches a list of video sites AND Medium matches regex ^(.*cp.*|ppc|retargeting|paid.*)$",
      recommendedMediums: ["cpc", "ppc", "paid", "retargeting"],
      recommendedSources: R.SOURCE_CATEGORY_VIDEO
    }, {
      name: "Referral",
      description: "Referral is the channel by which users arrive at your site via non-ad links on other sites/apps (e.g., blogs, news sites).",
      condition: 'Medium is one of ("referral", "app", or "link")',
      recommendedMediums: ["referral", "app", "link"],
      recommendedSources: []
    }, {
      name: "SMS",
      description: "SMS is the channel by which users arrive at your site/app via links from text messages.",
      condition: "Source exactly matches sms OR Medium exactly matches sms",
      recommendedMediums: ["sms"],
      recommendedSources: ["sms"]
    }];


    // Helper functions for GA4 channel prediction (these remain the same as they are pure JS functions)
    const Ye = (n) => {
      const g = n.toLowerCase().trim();
      for (const [i, r] of Object.entries(R))
        if (r.some(s => s.toLowerCase() === g))
          return i;
      return null
    };

    const we = (n, g, i) => {
      const r = n.toLowerCase().trim(),
        s = g.toLowerCase().trim(),
        f = i.toLowerCase().trim();
      if (r === "(direct)" && (s === "(not set)" || s === "(none)"))
        return "Direct";
      if (f.includes("cross-network"))
        return "Cross-network";
      const p = Ye(r),
        j = p === "SOURCE_CATEGORY_SEARCH",
        m = p === "SOURCE_CATEGORY_SOCIAL",
        h = p === "SOURCE_CATEGORY_SHOPPING",
        d = p === "SOURCE_CATEGORY_VIDEO",
        b = /^(.*cp.*|ppc|retargeting|paid.*)$/.test(s),
        S = /^(.*(([^a-df-z]|^)shop|shopping).*)$/.test(f);
      return (h || S) && b ? "Paid Shopping" : j && b ? "Paid Search" : m && b ? "Paid Social" : d && b ? "Paid Video" : ["display", "banner", "expandable", "interstitial", "cpm"].includes(s) ? "Display" : b ? "Paid Other" : h || S ? "Organic Shopping" : m || ["social", "social-network", "social-media", "sm", "social network", "social media"].includes(s) ? "Organic Social" : d || /^(.*video.*)$/.test(s) ? "Organic Video" : j || s === "organic" ? "Organic Search" : ["referral", "app", "link"].includes(s) ? "Referral" : ["email", "e-mail", "e_mail", "e mail"].includes(r) || ["email", "e-mail", "e_mail", "e mail"].includes(s) ? "Email" : s === "affiliate" ? "Affiliates" : s === "audio" ? "Audio" : r === "sms" || s === "sms" ? "SMS" : s.endsWith("push") || s.includes("mobile") || s.includes("notification") || r === "firebase" ? "Mobile Push Notifications" : "Unassigned"
    };

    const Be = (n, g, i, r) => {
      n.toLowerCase().trim();
      g.toLowerCase().trim();
      const s = i.toLowerCase().trim();
      switch (r) {
        case "Direct":
          return "Users typed your URL directly or used a bookmark";
        case "Cross-network":
          return 'Campaign name contains "cross-network" indicating multi-network ads';
        case "Paid Shopping":
          return s.includes("shop") ? "Campaign name contains shopping keywords and uses paid advertising" : "Traffic from shopping sites using paid advertising";
        case "Paid Search":
          return "Paid ads on search engines like Google or Bing";
        case "Paid Social":
          return "Paid ads on social media platforms";
        case "Paid Video":
          return "Paid ads on video platforms like YouTube";
        case "Display":
          return "Display advertising (banners, visual ads)";
        case "Paid Other":
          return "Paid advertising that doesn't fit other specific categories";
        case "Organic Shopping":
          return "Non-paid links from shopping sites";
        case "Organic Social":
          return "Non-paid links from social media platforms";
        case "Organic Video":
          return "Non-paid links from video platforms";
        case "Organic Search":
          return "Non-paid search results from search engines";
        case "Referral":
          return "Links from other websites (blogs, news sites, etc.)";
        case "Email":
          return "Links from email campaigns";
        case "Affiliates":
          return "Links from affiliate marketing partners";
        case "Audio":
          return "Ads on audio platforms like podcasts";
        case "SMS":
          return "Links from text messages";
        case "Mobile Push Notifications":
          return "Links from mobile app notifications";
        default:
          return "Parameters don't match any standard GA4 channel definition"
      }
    };

    document.addEventListener('DOMContentLoaded', function () {
      const utmForm = document.getElementById('utm-form');
      const websiteUrlInput = document.getElementById('website-url');
      const ga4ChannelSelect = document.getElementById('ga4-channel-select'); // Get the GA4 Channel select element
      const sourceSelect = document.getElementById('source');
      const mediumSelect = document.getElementById('medium');
      const campaignInput = document.getElementById('campaign');
      const utmTermInput = document.getElementById('utm_term');
      const utmContentInput = document.getElementById('utm_content');
      const utmIdInput = document.getElementById('utm_id');
      const utmSourcePlatformInput = document.getElementById('utm_source_platform');
      const utmCreativeFormatInput = document.getElementById('utm_creative_format');
      const utmMarketingTacticInput = document.getElementById('utm_marketing_tactic');
      const resultTextarea = document.getElementById('result');
      const copyGeneratedUrlButton = document.getElementById('copy-generated-url');

      const addCustomParamButton = document.getElementById('add-custom-param');
      const customParamsContainer = document.getElementById('custom-params-container');
      const noCustomParamsMessage = document.getElementById('no-custom-params-message');

      let customParams = [];

      // --- Toast/Notification System (simplified) ---
      function showSuccessToast(message) {
        console.log("Success:", message);
        // Implement your visual toast notification here if needed
      }

      function showErrorToast(message) {
        console.error("Error:", message);
        // Implement your visual error notification here if needed
      }
      // --- End Toast System ---

      // Helper for URL validation
      function isValidUrl(url) {
        try {
          new URL(url);
          return true;
        } catch (e) {
          return false;
        }
      }

      // Function to populate the GA4 Channel dropdown
      function populateGa4ChannelDropdown() {
        // No need to clear "All channels (no filtering)" as it's static in HTML
        z.forEach(channel => {
          const option = document.createElement('option');
          option.value = channel.name;
          option.textContent = channel.name;
          ga4ChannelSelect.appendChild(option);
        });
      }

      // Function to populate the Source dropdown based on selected GA4 channel
      function populateSourceDropdown() {
        sourceSelect.innerHTML = '';
        sourceSelect.add(new Option('Select Source', '')); // Default empty option

        const selectedChannelName = ga4ChannelSelect.value;
        let filteredSources = [];

        if (selectedChannelName === "") { // "All channels (no filtering)" selected
          // Include all sources from R object, categorized
          const allSources = {};
          for (const category in R) {
            const categoryName = category.replace("SOURCE_CATEGORY_", "").charAt(0).toUpperCase() + category.replace("SOURCE_CATEGORY_", "").slice(1).toLowerCase();
            allSources[categoryName] = R[category];
          }

          for (const label in allSources) {
            const optgroup = document.createElement('optgroup');
            optgroup.label = label;
            allSources[label].sort().forEach(source => {
              const option = document.createElement('option');
              option.value = source;
              option.textContent = source;
              optgroup.appendChild(option);
            });
            sourceSelect.appendChild(optgroup);
          }

        } else {
          const selectedChannel = z.find(channel => channel.name === selectedChannelName);
          if (selectedChannel && selectedChannel.recommendedSources.length > 0) {
            // Populate with recommended sources for the selected channel
            const recommendedSources = selectedChannel.recommendedSources;

            // Group recommended sources by their original R.SOURCE_CATEGORY
            const categorizedRecommendedSources = {};
            for (const categoryKey in R) {
              const categoryName = categoryKey.replace("SOURCE_CATEGORY_", "").charAt(0).toUpperCase() + categoryKey.replace("SOURCE_CATEGORY_", "").slice(1).toLowerCase();
              const sourcesInCategory = R[categoryKey];
              const intersection = recommendedSources.filter(source => sourcesInCategory.includes(source));
              if (intersection.length > 0) {
                categorizedRecommendedSources[categoryName] = intersection;
              }
            }
            // Add any recommended sources that aren't in R categories directly
            recommendedSources.forEach(source => {
              let foundInR = false;
              for (const categoryKey in R) {
                if (R[categoryKey].includes(source)) {
                  foundInR = true;
                  break;
                }
              }
              if (!foundInR) {
                if (!categorizedRecommendedSources["Other"]) {
                  categorizedRecommendedSources["Other"] = [];
                }
                categorizedRecommendedSources["Other"].push(source);
              }
            });


            for (const label in categorizedRecommendedSources) {
              const optgroup = document.createElement('optgroup');
              optgroup.label = label;
              categorizedRecommendedSources[label].sort().forEach(source => {
                const option = document.createElement('option');
                option.value = source;
                option.textContent = source;
                optgroup.appendChild(option);
              });
              sourceSelect.appendChild(optgroup);
            }

          } else {
            // If no specific recommended sources, fall back to general categories
            // This case handles channels like "Email", "Affiliates", "SMS" which have
            // simple source conditions or don't explicitly list numerous sources in R.
            // For example, "Email" has "email" as a recommended source.
            // If no recommended sources, show all.
             const allSources = {};
            for (const category in R) {
              const categoryName = category.replace("SOURCE_CATEGORY_", "").charAt(0).toUpperCase() + category.replace("SOURCE_CATEGORY_", "").slice(1).toLowerCase();
              allSources[categoryName] = R[category];
            }

            for (const label in allSources) {
              const optgroup = document.createElement('optgroup');
              optgroup.label = label;
              allSources[label].sort().forEach(source => {
                const option = document.createElement('option');
                option.value = source;
                option.textContent = source;
                optgroup.appendChild(option);
              });
              sourceSelect.appendChild(optgroup);
            }
          }
        }
      }


      // Function to populate the Medium dropdown based on selected GA4 channel
      function populateMediumDropdown() {
        mediumSelect.innerHTML = '';
        mediumSelect.add(new Option('Select Medium', '')); // Default empty option

        const selectedChannelName = ga4ChannelSelect.value;
        let filteredMediums = [];

        const allMediumOptions = [{
          value: "cpc",
          label: "cpc",
          category: "Paid",
          description: "Cost per click"
        }, {
          value: "ppc",
          label: "ppc",
          category: "Paid",
          description: "Pay per click"
        }, {
          value: "paid",
          label: "paid",
          category: "Paid",
          description: "General paid traffic"
        }, {
          value: "retargeting",
          label: "retargeting",
          category: "Paid",
          description: "Retargeting campaigns"
        }, {
          value: "display",
          label: "display",
          category: "Display",
          description: "Display advertising"
        }, {
          value: "banner",
          label: "banner",
          category: "Display",
          description: "Banner ads"
        }, {
          value: "expandable",
          label: "expandable",
          category: "Display",
          description: "Expandable ads"
        }, {
          value: "interstitial",
          label: "interstitial",
          category: "Display",
          description: "Interstitial ads"
        }, {
          value: "cpm",
          label: "cpm",
          category: "Display",
          description: "Cost per mille"
        }, {
          value: "organic",
          label: "organic",
          category: "Organic",
          description: "Organic search"
        }, {
          value: "referral",
          label: "referral",
          category: "Organic",
          description: "Referral traffic"
        }, {
          value: "social",
          label: "social",
          category: "Social",
          description: "Social media"
        }, {
          value: "social-network",
          label: "social-network",
          category: "Social",
          description: "Social network"
        }, {
          value: "social-media",
          label: "social-media",
          category: "Social",
          description: "Social media"
        }, {
          value: "email",
          label: "email",
          category: "Email",
          description: "Email marketing"
        }, {
          value: "affiliate",
          label: "affiliate",
          category: "Affiliate",
          description: "Affiliate marketing"
        }, {
          value: "video",
          label: "video",
          category: "Video",
          description: "Video advertising"
        }, {
          value: "audio",
          label: "audio",
          category: "Audio",
          description: "Audio advertising"
        }, {
          value: "sms",
          label: "sms",
          category: "SMS",
          description: "SMS marketing"
        }, {
          value: "push",
          label: "push",
          category: "Push",
          description: "Push notifications"
        }];


        if (selectedChannelName === "") { // "All channels (no filtering)" selected
          filteredMediums = allMediumOptions;
        } else {
          const selectedChannel = z.find(channel => channel.name === selectedChannelName);
          if (selectedChannel && selectedChannel.recommendedMediums.length > 0) {
            filteredMediums = allMediumOptions.filter(medium =>
              selectedChannel.recommendedMediums.includes(medium.value)
            );
          } else {
            // If no specific recommended mediums, show all general mediums
            filteredMediums = allMediumOptions;
          }
        }

        const categorizedFilteredMediums = filteredMediums.reduce((acc, option) => {
          if (!acc[option.category]) {
            acc[option.category] = [];
          }
          acc[option.category].push(option);
          return acc;
        }, {});

        for (const category in categorizedFilteredMediums) {
          const optgroup = document.createElement('optgroup');
          optgroup.label = category;
          categorizedFilteredMediums[category].sort((a, b) => a.label.localeCompare(b.label)).forEach(option => {
            const opt = document.createElement('option');
            opt.value = option.value;
            opt.textContent = option.label;
            optgroup.appendChild(opt);
          });
          mediumSelect.appendChild(optgroup);
        }
      }


      // Function to generate the UTM URL (remains the same)
      function generateUtmUrl() {
        const baseUrl = websiteUrlInput.value.trim();
        const source = sourceSelect.value.trim();
        const medium = mediumSelect.value.trim();
        const campaign = campaignInput.value.trim();
        const term = utmTermInput.value.trim();
        const content = utmContentInput.value.trim();
        const id = utmIdInput.value.trim();
        const sourcePlatform = utmSourcePlatformInput.value.trim();
        const creativeFormat = utmCreativeFormatInput.value.trim();
        const marketingTactic = utmMarketingTacticInput.value.trim();

        if (!baseUrl) {
          resultTextarea.value = "Please enter a Website URL.";
          return;
        }

        if (!isValidUrl(baseUrl)) {
          resultTextarea.value = "Invalid Website URL. Please include http:// or https://";
          return;
        }

        try {
          const url = new URL(baseUrl);
          const params = url.searchParams;

          // Clear existing utm parameters to avoid duplicates if URL is re-analyzed
          for (let key of Array.from(params.keys())) {
            if (key.startsWith('utm_')) {
              params.delete(key);
            }
          }

          if (source) params.set('utm_source', source);
          if (medium) params.set('utm_medium', medium);
          if (campaign) params.set('utm_campaign', campaign);
          if (term) params.set('utm_term', term);
          if (content) params.set('utm_content', content);
          if (id) params.set('utm_id', id);
          if (sourcePlatform) params.set('utm_source_platform', sourcePlatform);
          if (creativeFormat) params.set('utm_creative_format', creativeFormat);
          if (marketingTactic) params.set('utm_marketing_tactic', marketingTactic);

          // Add custom parameters
          customParams.forEach(param => {
            if (param.key && param.value) {
              params.set(param.key, param.value);
            }
          });

          url.search = params.toString();
          resultTextarea.value = url.toString();

        } catch (err) {
          resultTextarea.value = "Error generating URL. Please check the base URL.";
          console.error("Error generating URL:", err);
        }
      }

      // --- Custom Parameters Logic (remains the same) ---
      function renderCustomParams() {
        customParamsContainer.innerHTML = ''; // Clear existing
        if (customParams.length === 0) {
          noCustomParamsMessage.classList.remove('hidden');
        } else {
          noCustomParamsMessage.classList.add('hidden');
          customParams.forEach((param, index) => {
            const paramDiv = document.createElement('div');
            paramDiv.className = 'flex gap-3 items-end';
            paramDiv.innerHTML = `
              <div class="flex-1">
                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Parameter Key</label>
                <input type="text" class="form-input w-input custom-param-key" placeholder="e.g., custom_param" value="${param.key}">
              </div>
              <div class="flex-1">
                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Parameter Value</label>
                <input type="text" class="form-input w-input custom-param-value" placeholder="e.g., custom_value" value="${param.value}">
              </div>
              <button type="button" class="button-small bg-red-600 hover:bg-red-700 text-white remove-custom-param">Remove</button>
            `;
            customParamsContainer.appendChild(paramDiv);

            paramDiv.querySelector('.custom-param-key').addEventListener('input', (e) => {
              customParams[index].key = e.target.value;
              generateUtmUrl();
            });
            paramDiv.querySelector('.custom-param-value').addEventListener('input', (e) => {
              customParams[index].value = e.target.value;
              generateUtmUrl();
            });
            paramDiv.querySelector('.remove-custom-param').addEventListener('click', () => {
              customParams.splice(index, 1);
              renderCustomParams();
              generateUtmUrl();
            });
          });
        }
      }

      addCustomParamButton.addEventListener('click', () => {
        customParams.push({
          key: '',
          value: ''
        });
        renderCustomParams();
        generateUtmUrl();
      });
      // --- End Custom Parameters Logic ---


      // --- Event Listeners for Live Updates and Generation ---
      utmForm.addEventListener('submit', function (e) {
        e.preventDefault(); // Prevent default form submission
        generateUtmUrl();
      });

      // Crucial: Re-populate Source and Medium when GA4 Channel changes
      ga4ChannelSelect.addEventListener('change', () => {
        populateSourceDropdown();
        populateMediumDropdown();
        generateUtmUrl(); // Regenerate URL with new filtered values
      });

      websiteUrlInput.addEventListener('input', generateUtmUrl);
      sourceSelect.addEventListener('change', generateUtmUrl);
      mediumSelect.addEventListener('change', generateUtmUrl);
      campaignInput.addEventListener('input', generateUtmUrl);
      utmTermInput.addEventListener('input', generateUtmUrl);
      utmContentInput.addEventListener('input', generateUtmUrl);
      utmIdInput.addEventListener('input', generateUtmUrl);
      utmSourcePlatformInput.addEventListener('input', generateUtmUrl);
      utmCreativeFormatInput.addEventListener('input', generateUtmUrl);
      utmMarketingTacticInput.addEventListener('input', generateUtmUrl);

      copyGeneratedUrlButton.addEventListener('click', async () => {
        if (resultTextarea.value) {
          try {
            await navigator.clipboard.writeText(resultTextarea.value);
            copyGeneratedUrlButton.textContent = "Copied!";
            setTimeout(() => {
              copyGeneratedUrlButton.textContent = "Copy URL";
            }, 2000);
            showSuccessToast("URL copied to clipboard!");
          } catch (err) {
            showErrorToast("Failed to copy URL to clipboard.");
            console.error("Copy failed:", err);
          }
        }
      });


      // Initial setup calls
      populateGa4ChannelDropdown(); // Populate GA4 channel dropdown first
      populateSourceDropdown(); // Then populate source and medium based on initial (or filtered) GA4 channel
      populateMediumDropdown();
      renderCustomParams(); // Initialize custom params display
      generateUtmUrl(); // Generate on initial load with default values
    });
  </script>
</body>
</html>